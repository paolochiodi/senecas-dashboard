'use strict'

const sampleData = [{"traceId":"f50ecb6809994ed8","id":"f50ecb6809994ed8","name":"post:*","timestamp":1476181317920000,"duration":235000,"annotations":[{"timestamp":1476181317921000,"value":"cs","endpoint":{"serviceName":"api"}},{"timestamp":1476181317973000,"value":"sr","endpoint":{"serviceName":"post"}},{"timestamp":1476181318146000,"value":"ss","endpoint":{"serviceName":"post"}},{"timestamp":1476181318155000,"value":"cr","endpoint":{"serviceName":"api"}}]},{"traceId":"f50ecb6809994ed8","id":"3e014ea5d9139b83","name":"kind:entry,store:save","parentId":"f50ecb6809994ed8","timestamp":1476181317978000,"duration":167000,"annotations":[{"timestamp":1476181317979000,"value":"cs","endpoint":{"serviceName":"post"}},{"timestamp":1476181318028000,"value":"sr","endpoint":{"serviceName":"entry-store"}},{"timestamp":1476181318133000,"value":"ss","endpoint":{"serviceName":"entry-store"}},{"timestamp":1476181318145000,"value":"cr","endpoint":{"serviceName":"post"}}]},{"traceId":"f50ecb6809994ed8","id":"9053223936c06889","name":"cmd:save,role:entity","parentId":"3e014ea5d9139b83","timestamp":1476181318034000,"duration":5000,"annotations":[{"timestamp":1476181318035000,"value":"cs","endpoint":{"serviceName":"entry-store"}},{"timestamp":1476181318039000,"value":"cr","endpoint":{"serviceName":"entry-store"}}]},{"traceId":"f50ecb6809994ed8","id":"cf7d46e9003159cf","name":"info:entry","parentId":"3e014ea5d9139b83","timestamp":1476181318152000,"duration":7000,"annotations":[{"timestamp":1476181318152000,"value":"cs","endpoint":{"serviceName":"post"}},{"timestamp":1476181318159000,"value":"cr","endpoint":{"serviceName":"post"}}]},{"traceId":"f50ecb6809994ed8","id":"b484a22034af13e2","name":"timeline:*","parentId":"9053223936c06889","timestamp":1476181318054000,"duration":78000,"annotations":[{"timestamp":1476181318054000,"value":"cs","endpoint":{"serviceName":"entry-store"}},{"timestamp":1476181318112000,"value":"sr","endpoint":{"serviceName":"timeline-shard"}},{"timestamp":1476181318113000,"value":"ss","endpoint":{"serviceName":"timeline-shard"}},{"timestamp":1476181318132000,"value":"cr","endpoint":{"serviceName":"entry-store"}}]},{"traceId":"f50ecb6809994ed8","id":"68517b90348e3b45","name":"cmd:generate_id,role:basic","parentId":"9053223936c06889","timestamp":1476181318036000,"duration":1000,"annotations":[{"timestamp":1476181318036000,"value":"cs","endpoint":{"serviceName":"entry-store"}},{"timestamp":1476181318037000,"value":"cr","endpoint":{"serviceName":"entry-store"}}]},{"traceId":"f50ecb6809994ed8","id":"d2dc1564c62b6fc4","name":"search:insert","parentId":"cf7d46e9003159cf","timestamp":1476181318165000,"duration":3000,"annotations":[{"timestamp":1476181318165000,"value":"cs","endpoint":{"serviceName":"post"}},{"timestamp":1476181318168000,"value":"cr","endpoint":{"serviceName":"post"}},{"timestamp":1476181318218000,"value":"sr","endpoint":{"serviceName":"index"}},{"timestamp":1476181318224000,"value":"sr","endpoint":{"serviceName":"index"}},{"timestamp":1476181318287000,"value":"ss","endpoint":{"serviceName":"index"}}]},{"traceId":"f50ecb6809994ed8","id":"149fd84b78da5774","name":"fanout:entry","parentId":"cf7d46e9003159cf","timestamp":1476181318160000,"duration":2000,"annotations":[{"timestamp":1476181318160000,"value":"cs","endpoint":{"serviceName":"post"}},{"timestamp":1476181318162000,"value":"cr","endpoint":{"serviceName":"post"}},{"timestamp":1476181318217000,"value":"sr","endpoint":{"serviceName":"fanout"}},{"timestamp":1476181318223000,"value":"sr","endpoint":{"serviceName":"fanout"}},{"timestamp":1476181318225000,"value":"ss","endpoint":{"serviceName":"fanout"}}]},{"traceId":"f50ecb6809994ed8","id":"8feb9475edf0105d","name":"timeline:insert","parentId":"b484a22034af13e2","timestamp":1476181318127000,"duration":1000,"annotations":[{"timestamp":1476181318127000,"value":"cs","endpoint":{"serviceName":"timeline-shard"}},{"timestamp":1476181318128000,"value":"cr","endpoint":{"serviceName":"timeline-shard"}},{"timestamp":1476181318206000,"value":"sr","endpoint":{"serviceName":"timeline0"}},{"timestamp":1476181318209000,"value":"ss","endpoint":{"serviceName":"timeline0"}}]},{"traceId":"f50ecb6809994ed8","id":"5c0b7e6782850e20","name":"follow:*","parentId":"149fd84b78da5774","timestamp":1476181318236000,"duration":75000,"annotations":[{"timestamp":1476181318236000,"value":"cs","endpoint":{"serviceName":"fanout"}},{"timestamp":1476181318296000,"value":"sr","endpoint":{"serviceName":"follow"}},{"timestamp":1476181318300000,"value":"ss","endpoint":{"serviceName":"follow"}},{"timestamp":1476181318311000,"value":"cr","endpoint":{"serviceName":"fanout"}}]},{"traceId":"f50ecb6809994ed8","id":"41f42e0f564c39f4","name":"cmd:load,role:entity","parentId":"8feb9475edf0105d","timestamp":1476181318212000,"duration":1000,"annotations":[{"timestamp":1476181318212000,"value":"cs","endpoint":{"serviceName":"timeline0"}},{"timestamp":1476181318213000,"value":"cr","endpoint":{"serviceName":"timeline0"}}]},{"traceId":"f50ecb6809994ed8","id":"4cca6400c7250a4b","name":"cmd:save,role:entity","parentId":"8feb9475edf0105d","timestamp":1476181318214000,"duration":3000,"annotations":[{"timestamp":1476181318214000,"value":"cs","endpoint":{"serviceName":"timeline0"}},{"timestamp":1476181318217000,"value":"cr","endpoint":{"serviceName":"timeline0"}}]},{"traceId":"f50ecb6809994ed8","id":"59e9c3fd1387130b","name":"cmd:save,role:entity","parentId":"8feb9475edf0105d","timestamp":1476181318218000,"duration":1000,"annotations":[{"timestamp":1476181318218000,"value":"cs","endpoint":{"serviceName":"timeline0"}},{"timestamp":1476181318219000,"value":"cr","endpoint":{"serviceName":"timeline0"}}]}]
const Wreck = require('wreck')
const Qs = require('qs')

function yesterday () {
  return 3376808642
}

function findByMessage (message, done) {
  const url = "http://localhost:8080/api/v1/traces?"
  const options = {
    limit: 10,
    lookback: yesterday(),
    spanName: 'post:*' // message
  }

  Wreck.get(url + Qs.stringify(options), {json: 'force'}, function got(err, res, data) {
    // done(null, data[data.length - 1])
    done(null, sampleData)
  })
}


module.exports = {
  findByMessage: findByMessage
}